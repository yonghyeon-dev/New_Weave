/**
 * 세무 지식 베이스
 * 한국 세무 관련 지식 데이터
 */

export interface TaxKnowledgeItem {
  id: string;
  category: TaxCategory;
  title: string;
  content: string;
  keywords: string[];
  relatedTopics?: string[];
  effectiveDate?: string;
  expiryDate?: string;
  source?: string;
  examples?: string[];
  warnings?: string[];
  lastUpdated: string;
}

export type TaxCategory = 
  | '소득세'
  | '법인세'
  | '부가가치세'
  | '종합소득세'
  | '원천징수'
  | '4대보험'
  | '세액공제'
  | '절세전략'
  | '세무신고'
  | '세무조사';

/**
 * 세무 지식 데이터베이스
 */
export const taxKnowledgeDB: TaxKnowledgeItem[] = [
  {
    id: 'tk_001',
    category: '종합소득세',
    title: '개인사업자 종합소득세 신고 가이드 (2025년)',
    content: `개인사업자의 종합소득세는 매년 5월 1일부터 5월 31일까지 신고해야 합니다.

신고 대상:
- 사업소득이 있는 개인사업자
- 근로소득과 사업소득이 함께 있는 경우
- 기타소득이 300만원을 초과하는 경우

필요 서류:
1. 종합소득세 신고서
2. 재무제표(손익계산서, 재무상태표)
3. 원천징수영수증
4. 소득공제 증빙서류
5. 세액공제 증빙서류

신고 방법:
- 홈택스 전자신고
- 세무대리인을 통한 신고
- 세무서 방문 신고

2025년 주요 변경사항:
- 과세표준 6% 구간: 1,400만원 이하로 확대
- 결혼세액공제 신설: 2024~2026년 혼인 시 부부 합산 최대 100만원
- 성실신고확인 대상자: 6월 30일까지 신고 기한 연장`,
    keywords: ['종합소득세', '개인사업자', '5월신고', '소득세신고'],
    relatedTopics: ['세액공제', '소득공제', '사업소득'],
    examples: [
      '연매출 1억원 개인사업자의 경우, 간편장부 대상자로 기준경비율 적용 가능',
      '신용카드 사용액의 15~40% 소득공제 가능'
    ],
    warnings: [
      '신고 기한을 놓치면 무신고 가산세 20% 부과',
      '장부 미비치 시 무기장 가산세 부과 가능',
      '성실신고확인 대상자는 세무사 등의 확인 필수'
    ],
    lastUpdated: '2025-01-03'
  },
  {
    id: 'tk_002',
    category: '부가가치세',
    title: '부가가치세 신고 및 납부',
    content: `부가가치세는 분기별로 신고하며, 일반과세자와 간이과세자의 신고 주기가 다릅니다.

일반과세자:
- 1기 예정: 1.1~3.31 (4.25까지 신고)
- 1기 확정: 1.1~6.30 (7.25까지 신고)
- 2기 예정: 7.1~9.30 (10.25까지 신고)
- 2기 확정: 7.1~12.31 (다음해 1.25까지 신고)

간이과세자:
- 1.1~12.31 (다음해 1.25까지 신고)

세율:
- 일반세율: 10%
- 영세율: 0% (수출 등)

매입세액공제:
- 사업과 관련된 매입세액은 공제 가능
- 접대비, 개인적 사용 목적은 불공제`,
    keywords: ['부가가치세', 'VAT', '매입세액', '매출세액', '세금계산서'],
    relatedTopics: ['전자세금계산서', '영세율', '간이과세'],
    examples: [
      '매출 1,100만원(VAT 포함) = 매출액 1,000만원 + 부가세 100만원',
      '매입세액 50만원, 매출세액 100만원 → 납부세액 50만원'
    ],
    warnings: [
      '세금계산서 미발급 시 공급가액의 2% 가산세',
      '신고불성실 가산세는 납부세액의 10~40%'
    ],
    lastUpdated: '2024-02-01'
  },
  {
    id: 'tk_003',
    category: '세액공제',
    title: '개인사업자가 받을 수 있는 세액공제 (2025년)',
    content: `개인사업자가 활용할 수 있는 주요 세액공제 항목들입니다.

주요 세액공제:
1. 신용카드 등 소득공제
   - 총급여의 25% 초과 사용액의 15~40%
   - 전통시장 40%, 대중교통 40%, 일반 15%
   - 한도: 연 300만원 (총급여 7천만원 이하), 250만원 (7천만원 초과)
   - 추가한도: 전통시장/대중교통/문화체육 합계 300만원

2. 연금계좌 세액공제
   - 연 900만원 한도 (연금저축 600만원, IRP 포함 900만원)
   - 총급여 5,500만원 이하: 16.5%
   - 총급여 5,500만원 초과: 13.2%

3. 보험료 세액공제
   - 보장성보험: 연 100만원 한도, 12%
   - 장애인전용보험: 연 100만원 한도, 15%

4. 의료비 세액공제
   - 총급여의 3% 초과액의 15%
   - 난임시술비: 30%
   - 미숙아·선천성이상아: 20%
   - 한도: 연 700만원 (본인·65세이상·장애인·6세이하는 한도 없음)

5. 교육비 세액공제
   - 본인: 전액, 15%
   - 자녀: 유치원~고등학생 300만원, 대학생 900만원 한도

6. 자녀세액공제 (2025년)
   - 첫째: 25만원, 둘째: 30만원, 셋째 이상: 40만원

7. 결혼세액공제 (신설)
   - 2024~2026년 혼인신고 시 부부 합산 최대 100만원

8. 체육활동 지원 소득공제 (2025.7.1부터)
   - 총급여 7천만원 이하: 수영장·체육시설 이용료
   - 연 300만원 한도, 소득공제율 30%`,
    keywords: ['세액공제', '소득공제', '연말정산', '절세'],
    relatedTopics: ['종합소득세', '근로소득', '사업소득'],
    examples: [
      '연봉 5,000만원, 신용카드 2,000만원 사용 → 187.5만원 소득공제',
      '연금저축 400만원 납입 → 66만원 세액공제 (16.5%)',
      '결혼 첫해 부부 → 100만원 결혼세액공제'
    ],
    warnings: [
      '증빙서류 미제출 시 공제 불가',
      '허위 공제 신청 시 가산세 부과',
      '신용카드 소득공제는 2025년 말 일몰 예정 (연장 가능성 높음)'
    ],
    lastUpdated: '2025-01-03'
  },
  {
    id: 'tk_004',
    category: '4대보험',
    title: '개인사업자 4대보험 가입 및 보험료 (2025년)',
    content: `개인사업자의 4대보험 가입 의무와 보험료 계산 방법입니다.

1. 국민연금
   - 기준소득월액의 9%
   - 상한: 637만원, 하한: 40만원
   - 본인 전액 부담
   - 2025년부터 2040년까지 나이별로 차등 인상 예정 (최종 13%)

2. 건강보험
   - 소득 기준: 보험료부과점수 × 점수당 금액
   - 2025년 기준: 7.09% (2년 연속 동결)
   - 장기요양보험: 건강보험료의 12.95%

3. 고용보험 (자영업자 고용보험)
   - 선택 가입
   - 기준보수의 1.8% (실업급여)
   - 실업급여 수급 가능

4. 산재보험
   - 특수형태근로종사자만 의무 가입
   - 일반 개인사업자는 임의 가입
   - 업종별 요율 + 출퇴재해 0.06%

사업소득 4,000만원 기준 예시:
- 국민연금: 월 30만원
- 건강보험: 월 23.6만원
- 장기요양: 월 3.1만원
합계: 월 56.7만원

직원 채용 시 변화:
- 사업주도 직장가입자로 전환
- 첫 직원 2명 이상: 최고 급여 직원 기준
- 이후 종합소득세 신고 후 소득금액으로 변경`,
    keywords: ['4대보험', '국민연금', '건강보험', '고용보험', '산재보험'],
    relatedTopics: ['사회보험', '보험료', '자영업자'],
    examples: [
      '월소득 300만원 → 국민연금 27만원, 건강보험 21.3만원',
      '자영업자 고용보험 가입 시 폐업 후 실업급여 수급 가능'
    ],
    warnings: [
      '국민연금 미납 시 가산금 부과',
      '건강보험료 6개월 이상 체납 시 급여 제한'
    ],
    lastUpdated: '2025-01-03'
  },
  {
    id: 'tk_005',
    category: '원천징수',
    title: '사업자의 원천징수 의무',
    content: `사업자가 급여, 퇴직금, 기타소득 등을 지급할 때 원천징수해야 합니다.

원천징수 대상:
1. 근로소득 (급여, 상여금)
   - 간이세액표에 따라 원천징수
   - 다음달 10일까지 납부

2. 퇴직소득
   - 퇴직소득세율 적용
   - 근속연수 공제 후 과세

3. 사업소득
   - 원천징수 대상 사업소득의 3%
   - 의료업, 약사 등 특정 업종

4. 기타소득
   - 지급액의 20% (필요경비 80% 인정 시 4%)
   - 강연료, 원고료 등

5. 이자·배당소득
   - 이자소득: 14% (지방소득세 포함 15.4%)
   - 배당소득: 14% (지방소득세 포함 15.4%)

원천징수 절차:
1. 소득 지급 시 세금 원천징수
2. 원천징수영수증 발급
3. 다음달 10일까지 세무서 납부
4. 반기별 원천징수이행상황신고`,
    keywords: ['원천징수', '원천세', '급여', '근로소득세'],
    relatedTopics: ['간이세액표', '원천징수영수증', '지급명세서'],
    examples: [
      '월급 300만원 → 원천징수세액 약 15만원 (부양가족 없는 경우)',
      '강연료 100만원 → 기타소득 원천세 4만원 (필요경비 80% 인정)'
    ],
    warnings: [
      '원천징수 누락 시 가산세 10% 부과',
      '지급명세서 미제출 시 지급금액의 2% 가산세'
    ],
    lastUpdated: '2024-01-25'
  },
  {
    id: 'tk_006',
    category: '절세전략',
    title: '개인사업자 합법적 절세 전략 (2025년)',
    content: `개인사업자가 활용할 수 있는 합법적인 절세 방법들입니다.

1. 적격증빙 수취
   - 모든 경비는 세금계산서, 계산서, 신용카드 영수증으로
   - 간이영수증은 건당 3만원 이하만 인정

2. 소득 분산
   - 가족을 직원으로 고용하여 인건비 처리
   - 배우자, 직계존비속 급여 지급

3. 감가상각 활용
   - 차량, 컴퓨터 등 자산의 감가상각비 계상
   - 즉시상각 특례 활용 (중소기업)

4. 접대비 한도 관리 (2025년)
   - 일반기업: 기본 1,200만원
   - 중소기업: 기본 3,600만원
   - 수입금액별 추가: 100억 이하 0.3%, 100억~500억 0.2%
   - 문화접대비: 일반 접대비 한도의 20%
   - 전통시장 접대비: 일반 접대비 한도의 10%
   - 경조사비: 20만원까지 청첩장/부고장으로 인정

5. 노란우산공제 가입
   - 소득공제 한도: 연 500만원
   - 폐업/퇴임 시 목돈 수령
   - 압류 방지 효과

6. 성실신고확인제 활용
   - 대상: 도소매업 15억원, 전문직 7.5억원 이상
   - 성실신고확인 시 의료비·교육비 세액공제
   - 성실신고확인비용 세액공제 (120만원 한도)

7. 중소기업 특별세액감면
   - 소기업: 10~20% 세액감면
   - 업종 및 지역에 따라 차등 적용

8. 2025년 신규 절세 방법
   - 결혼세액공제: 2024~2026년 혼인 시 최대 100만원
   - 체육활동 소득공제: 연 300만원 한도 30% (7월부터)`,
    keywords: ['절세', '세금절약', '세테크', '합법절세'],
    relatedTopics: ['세액공제', '소득공제', '비용처리'],
    examples: [
      '배우자 월 150만원 급여 → 연 1,800만원 인건비 처리',
      '업무용 차량 5,000만원 → 연간 1,000만원 감가상각비',
      '중소기업 문화접대비 → 일반 접대비 3,600만원의 20% 추가 인정'
    ],
    warnings: [
      '과도한 경비 처리 시 세무조사 대상',
      '가공경비 계상 시 조세포탈죄 적용 가능'
    ],
    lastUpdated: '2025-01-03'
  },
  {
    id: 'tk_007',
    category: '세무조사',
    title: '세무조사 대응 방법',
    content: `세무조사를 받게 되었을 때의 대응 방법과 준비사항입니다.

세무조사 유형:
1. 정기조사: 4~5년 주기로 실시
2. 수시조사: 탈세 제보, 이상 징후 발견 시
3. 전산조사: 전산 분석을 통한 서면 조사
4. 현장확인: 사업장 실태 확인

사전 준비사항:
- 장부 및 증빙서류 정리
- 세금계산서 발급 내역 확인
- 인건비 지급 내역 점검
- 접대비, 복리후생비 증빙 확인
- 재고자산 실사 준비

조사 진행 시 유의사항:
1. 조사 범위와 기간 확인
2. 세무대리인 선임 고려
3. 성실한 자료 제출
4. 조사관과 원만한 관계 유지
5. 이의신청 권리 숙지

조사 종료 후:
- 추징세액 확인 및 납부
- 불복 시 이의신청 (90일 이내)
- 심사청구, 심판청구 가능
- 행정소송 제기 가능`,
    keywords: ['세무조사', '세무검사', '국세청조사', '탈세조사'],
    relatedTopics: ['추징', '가산세', '이의신청'],
    examples: [
      '매출 누락 10% → 추징세액 + 가산세 40% 부과 가능',
      '가공경비 5,000만원 → 추징 + 가산세 + 형사처벌 가능'
    ],
    warnings: [
      '자료 은닉 시 형사처벌 가능',
      '허위 진술 시 가중처벌'
    ],
    lastUpdated: '2024-02-20'
  },
  {
    id: 'tk_008',
    category: '종합소득세',
    title: '2025년 종합소득세율표',
    content: `2025년 귀속 종합소득세 과세표준 구간 및 세율입니다.

과세표준 구간별 세율:
- 1,400만원 이하: 6%
- 1,400만원 초과 ~ 5,000만원 이하: 15% 
- 5,000만원 초과 ~ 8,800만원 이하: 24%
- 8,800만원 초과 ~ 1.5억원 이하: 35%
- 1.5억원 초과 ~ 3억원 이하: 38%
- 3억원 초과 ~ 5억원 이하: 40%
- 5억원 초과 ~ 10억원 이하: 42%
- 10억원 초과: 45%

누진공제액:
- 1,400만원 이하: 0원
- 1,400만원 초과: 126만원
- 5,000만원 초과: 576만원
- 8,800만원 초과: 1,488만원
- 1.5억원 초과: 2,058만원
- 3억원 초과: 2,958만원
- 5억원 초과: 3,958만원
- 10억원 초과: 6,958만원

간편 계산법:
과세표준 × 세율 - 누진공제액 = 산출세액`,
    keywords: ['종합소득세율', '누진세', '과세표준', '세율표'],
    relatedTopics: ['종합소득세', '소득세', '산출세액'],
    examples: [
      '과세표준 3,000만원 → 3,000만원 × 15% - 126만원 = 324만원',
      '과세표준 1억원 → 1억원 × 35% - 1,488만원 = 2,012만원'
    ],
    warnings: [
      '과세표준은 총소득에서 각종 공제를 차감한 금액',
      '지방소득세 10%가 별도 부과됨'
    ],
    lastUpdated: '2025-01-03'
  },
  {
    id: 'tk_009',
    category: '절세전략',
    title: '노란우산공제 가입 혜택',
    content: `소기업·소상공인의 폐업·퇴임 시 생활안정을 위한 노란우산공제입니다.

가입 대상:
- 개인사업자 및 법인 대표
- 연매출 일정 금액 이하 소기업·소상공인

납입 한도 및 소득공제:
- 월 최대 100만원 납입 가능
- 연간 소득공제 한도: 500만원
- 2025년부터 한도 100만원씩 확대 예정

주요 혜택:
1. 소득공제 혜택
   - 사업소득금액 4천만원 이하: 연 500만원
   - 4천만원 초과 ~ 1억원 이하: 연 300만원
   - 1억원 초과: 연 200만원

2. 압류 방지
   - 공제금은 압류 대상에서 제외
   - 폐업 시에도 생활자금 보장

3. 복리 이자
   - 시중금리 수준의 복리 이자 적용
   - 비과세 혜택

4. 대출 혜택
   - 납입액의 90%까지 대출 가능
   - 저금리 혜택

지급 사유:
- 폐업, 사망, 퇴임
- 노령(만 60세 이상)
- 가입 후 10년 경과`,
    keywords: ['노란우산공제', '폐업공제', '소상공인공제', '절세'],
    relatedTopics: ['소득공제', '절세전략', '퇴직연금'],
    examples: [
      '월 50만원 납입 → 연 600만원 중 500만원 소득공제',
      '사업소득 3천만원 → 연 500만원 한도 소득공제'
    ],
    warnings: [
      '중도해지 시 원금 손실 가능',
      '소득공제 한도는 사업소득 규모에 따라 차등'
    ],
    lastUpdated: '2025-01-03'
  },
  {
    id: 'tk_010',
    category: '부가가치세',
    title: '2025년 부가가치세 가산세 강화',
    content: `2025년부터 강화된 부가가치세 가산세 규정입니다.

주요 가산세 변경사항:

1. 명의위장 가산세 강화
   - 일반과세자: 공급가액의 1% → 2%로 상향
   - 간이과세자: 공급가액의 0.5% → 1%로 상향

2. 세금계산서 관련 가산세
   - 미발급: 공급가액의 2%
   - 지연발급: 공급가액의 1%
   - 가공/위장 세금계산서: 공급가액의 2%

3. 신고불성실 가산세
   - 무신고: 납부세액의 20%
   - 과소신고: 납부세액의 10%
   - 초과환급신고: 초과환급세액의 10%

4. 납부불성실 가산세
   - 미납/과소납부: 미납세액 × 2.5/10,000 × 경과일수

5. 영세율 과세표준 신고불성실 가산세
   - 미신고/과소신고: 공급가액의 0.5%

개인택시 면세 전환 (2025.1.1부터):
- 개인택시 간이과세자 자동차 구입 시
- 부가가치세 부과 후 환급 방식으로 변경
- 2027.12.31까지 환급 적용`,
    keywords: ['부가가치세', '가산세', '명의위장', '세금계산서'],
    relatedTopics: ['부가가치세', '세무조사', '세금계산서'],
    examples: [
      '공급가액 1억원 명의위장 → 200만원 가산세 (일반과세자)',
      '세금계산서 미발급 1천만원 → 20만원 가산세'
    ],
    warnings: [
      '반복적 위반 시 가중처벌',
      '명의위장은 형사처벌 대상'
    ],
    lastUpdated: '2025-01-03'
  }
];

/**
 * 세무 지식 검색 클래스
 */
export class TaxKnowledgeSearch {
  /**
   * 키워드로 세무 지식 검색
   */
  searchByKeywords(keywords: string[]): TaxKnowledgeItem[] {
    const normalizedKeywords = keywords.map(k => k.toLowerCase());
    
    return taxKnowledgeDB.filter(item => {
      const itemText = `${item.title} ${item.content} ${item.keywords.join(' ')}`.toLowerCase();
      return normalizedKeywords.some(keyword => itemText.includes(keyword));
    });
  }

  /**
   * 카테고리로 세무 지식 검색
   */
  searchByCategory(category: TaxCategory): TaxKnowledgeItem[] {
    return taxKnowledgeDB.filter(item => item.category === category);
  }

  /**
   * ID로 세무 지식 가져오기
   */
  getById(id: string): TaxKnowledgeItem | undefined {
    return taxKnowledgeDB.find(item => item.id === id);
  }

  /**
   * 관련 주제로 세무 지식 검색
   */
  searchRelatedTopics(topics: string[]): TaxKnowledgeItem[] {
    return taxKnowledgeDB.filter(item => 
      item.relatedTopics?.some(topic => 
        topics.some(t => t.toLowerCase() === topic.toLowerCase())
      )
    );
  }

  /**
   * 전체 카테고리 목록
   */
  getAllCategories(): TaxCategory[] {
    return [...new Set(taxKnowledgeDB.map(item => item.category))];
  }

  /**
   * 세무 달력 (중요 일정)
   */
  getTaxCalendar(): Array<{date: string, title: string, description: string}> {
    return [
      { date: '01-25', title: '부가가치세 확정신고', description: '2기 확정신고 및 납부' },
      { date: '03-10', title: '법인세 신고', description: '12월 결산법인 법인세 신고' },
      { date: '04-25', title: '부가가치세 예정신고', description: '1기 예정신고 및 납부' },
      { date: '05-31', title: '종합소득세 신고', description: '개인사업자 종합소득세 확정신고' },
      { date: '07-25', title: '부가가치세 확정신고', description: '1기 확정신고 및 납부' },
      { date: '10-25', title: '부가가치세 예정신고', description: '2기 예정신고 및 납부' }
    ];
  }
}

export default TaxKnowledgeSearch;